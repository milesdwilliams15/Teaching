---
title: "Working with survey data"
format: html
---


## Setup

```{r packages}
library(tidyverse)
library(socsci) # devtools::install_github("ryanburge/socsci")
theme_set(theme_bw())
```

```{r data}
wthh <- read_csv(
  "http://filesforprogress.org/datasets/wthh/DFP_WTHH_release.csv"
)
```


## Explore

```{r look at data}
wthh
```

link to codebook: https://www.filesforprogress.org/datasets/wthh/WTHH_Core_and_DFP_modules.pdf

## Recodes

Use `case_when()` to make recodes:

race What racial or ethnic group best describes you?
<1> White
<2> Black or African-American
<3> Hispanic or Latino
<4> Asian or Asian-American
<5> Native American
<8> Middle Eastern
<6> Mixed Race
<7> Other

```{r case_when}
wthh |>
  mutate(
    race_cat = case_when(
      race == 1 ~ "White",
      race == 2 ~ "Black",
      race == 3 ~ "Latino",
      race == 4 ~ "Asian",
      TRUE ~ "Other"
    )
  ) -> wthh

wthh |> select(race, race_cat)
```

Use `frcode()` to make recodes:

```{r frcode}
wthh |>
  mutate(
    race_catfr = frcode(
      race == 1 ~ "White",
      race == 2 ~ "Black",
      race == 3 ~ "Latino",
      race == 4 ~ "Asian",
      TRUE ~ "Other"
    )
  ) -> wthh
wthh |> select(race, race_cat, race_catfr)
```


```{r ct with race}
wthh |>
  ct(race_catfr)
```


```{r}
ggplot(wthh) +
  aes(race_catfr) +
  geom_bar()
```



Use `frcode()` with `pid7`:

```{r party lean}
wthh |>
  mutate(
    pid7_catfr = frcode(
      pid7 == 1 ~ "Strong Dem",
      pid7 == 2 ~ "Dem",
      pid7 == 3 ~ "Weak Dem",
      pid7 == 4 ~ "Ind",
      pid7 == 5 ~ "Weak Rep",
      pid7 == 6 ~ "Rep",
      pid7 == 7 ~ "Strong Rep",
      TRUE ~ "Other"
    )
  ) -> wthh
```

```{r}
ggplot(wthh) +
  aes(pid7_catfr) +
  geom_bar()
```



Use `ct()` to summarize distribution of party lean:

```{r ct party lean}

```

Use `ifelse()` for binary categories:

```{r recode gender}

```

Use mathematical operations to recode age:

```{r recode age}

```


Making age a category:

```{r age category}
 
```

## Data viz

Make a bar plot of party lean:

```{r party lean viz}

```

Make a bar plot of party lean weighted:

```{r weighted party lean viz}

```

Make a bar plot that breaks party lean down by age category:

```{r party lean by age category}

```

